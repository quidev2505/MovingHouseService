{"version":3,"file":"renderers.js","sourceRoot":"","sources":["../src/renderers.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link, Text, View, Image } from '@react-pdf/renderer';\nimport { HtmlRenderer, HtmlRenderers } from './render';\nimport { HtmlElement } from './parse';\nimport { HtmlStyle } from './styles';\nimport { lowerAlpha, orderedAlpha, upperAlpha } from './ordered.type';\n\nexport const renderNoop: HtmlRenderer = ({ children }) => <></>;\n\nexport const renderPassThrough: React.FC<React.PropsWithChildren<any>> = ({\n  children,\n}) => children;\n\nexport const renderBlock: HtmlRenderer = ({ style, children }) => (\n  <View style={style}>{children}</View>\n);\n\nexport const renderInline: HtmlRenderer = ({ style, children }) => (\n  <Text style={style}>{children}</Text>\n);\n\nexport const renderCell: HtmlRenderer = ({ style, element, children }) => {\n  const table = element.closest('table') as HtmlElement | undefined;\n  if (!table) {\n    throw new Error('td element rendered outside of a table');\n  }\n  const tableStyles = table.style.reduce(\n    (combined, tableStyle) => Object.assign(combined, tableStyle),\n    {} as HtmlStyle\n  );\n  const baseStyles: HtmlStyle = {\n    border: tableStyles.border,\n    borderColor: tableStyles.borderColor,\n    borderWidth: tableStyles.borderWidth,\n    borderStyle: tableStyles.borderStyle,\n  };\n  if (\n    (tableStyles as any).borderSpacing &&\n    (tableStyles as any).borderCollapse !== 'collapse'\n  ) {\n    baseStyles.width = tableStyles.borderWidth;\n    baseStyles.margin = (tableStyles as any).borderSpacing;\n  } else {\n    baseStyles.borderRightWidth = 0;\n    baseStyles.borderBottomWidth = 0;\n    if (element.indexOfType !== 0) {\n      baseStyles.borderLeftWidth = tableStyles.borderWidth;\n      baseStyles.borderTopWidth = tableStyles.borderWidth;\n    }\n  }\n\n  const overrides: HtmlStyle = {};\n  if (element.attributes && element.attributes.colspan) {\n    const colspan = parseInt(element.attributes.colspan, 10);\n    if (!isNaN(colspan)) {\n      overrides.flexBasis = colspan;\n    }\n  }\n\n  return <View style={[baseStyles, ...style, overrides]}>{children}</View>;\n};\n\nconst renderers: HtmlRenderers = {\n  style: renderNoop,\n  script: renderNoop,\n  html: renderPassThrough,\n  li: ({ element, stylesheets, style, children }) => {\n    const bulletStyles = stylesheets.map((stylesheet) => stylesheet.li_bullet);\n    const contentStyles = stylesheets.map(\n      (stylesheet) => stylesheet.li_content\n    );\n    const list: HtmlElement = element.closest('ol, ul') as HtmlElement;\n    const ordered = list?.tag === 'ol' || element.parentNode.tag === 'ol';\n    const listStyle =\n      list?.style?.reduce(\n        (combined, listStyle) => Object.assign(combined, listStyle),\n        {} as HtmlStyle\n      ) || {};\n    const itemStyle = element.style.reduce(\n      (combined, itemStyle) => Object.assign(combined, itemStyle),\n      {} as HtmlStyle\n    );\n    const listStyleType =\n      itemStyle.listStyleType ||\n      itemStyle.listStyle ||\n      listStyle.listStyleType ||\n      listStyle.listStyle ||\n      '';\n\n    let bullet;\n    if (listStyleType.includes('none')) {\n      bullet = false;\n    } else if (listStyleType.includes('url(')) {\n      bullet = (\n        <Image\n          src={listStyleType.match(/\\((.*?)\\)/)[1].replace(/(['\"])/g, '')}\n        />\n      );\n    } else if (ordered) {\n      if (lowerAlpha.includes(listStyleType)) {\n        bullet = (\n          <Text>{orderedAlpha[element.indexOfType].toLowerCase()}.</Text>\n        );\n      } else if (upperAlpha.includes(listStyleType)) {\n        bullet = (\n          <Text>{orderedAlpha[element.indexOfType].toUpperCase()}.</Text>\n        );\n      } else {\n        bullet = <Text>{element.indexOfType + 1}.</Text>;\n      }\n    } else {\n      // if (listStyleType.includes('square')) {\n      //   bullet = <Text>■</Text>;\n      // } else {\n      bullet = <Text>•</Text>;\n      // }\n    }\n\n    return (\n      <View style={style}>\n        {bullet && <View style={bulletStyles}>{bullet}</View>}\n        <View style={contentStyles}>{children}</View>\n      </View>\n    );\n  },\n  a: ({ style, element, children }) => (\n    <Link style={style} src={element.attributes.href}>\n      {children}\n    </Link>\n  ),\n  img: ({ style, element }) => (\n    <Image style={style} src={element.attributes.src} />\n  ),\n  table: ({ element, style, children }) => {\n    const tableStyles = element.style.reduce(\n      (combined, tableStyle) => Object.assign(combined, tableStyle),\n      {} as HtmlStyle\n    );\n    const overrides: HtmlStyle = {};\n    if (\n      !(tableStyles as any).borderSpacing ||\n      (tableStyles as any).borderCollapse === 'collapse'\n    ) {\n      overrides.borderLeftWidth = 0;\n      overrides.borderTopWidth = 0;\n    }\n\n    return <View style={[...style, overrides]}>{children}</View>;\n  },\n  tr: ({ style, children }) => (\n    <View wrap={false} style={style}>\n      {children}\n    </View>\n  ),\n  br: ({ style }) => (\n    <Text wrap={false} style={style}>\n      {'\\n'}\n    </Text>\n  ),\n  td: renderCell,\n  th: renderCell,\n};\n\nexport default renderers;\n"]}